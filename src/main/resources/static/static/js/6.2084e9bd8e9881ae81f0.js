webpackJsonp([6],{AxSN:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),o=a.n(r),s=a("W8/L"),i=a.n(s),n=a("glY1"),l=a("M1MM"),c=a("PJh5"),d=a.n(c),m=a("FWz8"),u=a("DKUc"),p=a("+cTw"),h=a.n(p),v={name:"OrderEdit",props:{record:{type:[Object,String],default:""}},data:function(){return{labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),price:"",count:"",totalPrice:"",oid:""}},methods:{show:function(e){this.visible=!0},edit:function(e){this.visible=!0;var t=this.form.setFieldsValue,a=h()(e,["hotel","user","room","checkInPerson","remark","price","count","totalPrice","status","createTime","startTime","endTime","oid"]);a.createTime=d()(e.createTime),a.startTime=d()(e.startTime),a.endTime=d()(e.endTime),this.price=a.price,this.count=a.count,this.totalPrice=a.totalPrice,this.oid=a.oid,this.$nextTick(function(){t({"user.uname":a.user.uname,"user.telephone":a.user.telephone,checkInPerson:a.checkInPerson,remark:a.remark,"hotel.hname":a.hotel.hname,"room.rname":a.room.rname,status:a.status,createTime:a.createTime,startTime:a.startTime,endTime:a.endTime})})},handleSubmit:function(){var e=this,t=this.form.validateFields;this.confirmLoading=!0,t(function(t,a){if(!t){var r={oid:e.oid,price:e.price,count:e.count,totalPrice:e.totalPrice};return Object(m.h)(o()({},a,r)).then(function(t){!0===t.success?(e.visible=!1,e.confirmLoading=!1,e.$emit("ok",a),e.$notification.success({message:"更新成功"})):(e.confirmLoading=!1,e.$notification.error({message:t.data}))})}e.confirmLoading=!1})},handleCancel:function(){this.visible=!1},handleChange:function(){var e=this.form.getFieldValue("startTime"),t=this.form.getFieldValue("endTime");this.totalPrice=Math.ceil(this.price*this.count*(t.date()-e.date()))},changeStartTime:function(e){var t=e,a=this.form.getFieldValue("endTime");this.totalPrice=Math.ceil(this.price*this.count*(a.date()-t.date()))},changeEndTime:function(e){var t=this.form.getFieldValue("startTime"),a=e;this.totalPrice=Math.ceil(this.price*this.count*(a.date()-t.date()))}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-modal",{attrs:{title:"编辑订单",width:640,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"下单时间",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["createTime"],expression:"['createTime']"}],staticStyle:{width:"100%"},attrs:{showTime:"",format:"YYYY/MM/DD HH:mm:ss",disabled:""}})],1),e._v(" "),a("a-form-item",{attrs:{label:"下单人",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["user.uname"],expression:"['user.uname']"}],attrs:{disabled:!0}})],1),e._v(" "),a("a-form-item",{attrs:{label:"联系电话",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["user.telephone"],expression:"['user.telephone']"}],attrs:{maxLength:11,disabled:!0}})],1),e._v(" "),a("a-form-item",{attrs:{label:"入住人",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkInPerson",{rules:[{required:!0,message:"入住人不能为空"}]}],expression:"['checkInPerson',\n           {rules: [{ required: true, message: '入住人不能为空' }]}]"}]})],1),e._v(" "),a("a-form-item",{attrs:{label:"酒店",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["hotel.hname"],expression:"['hotel.hname']"}],attrs:{disabled:!0}})],1),e._v(" "),a("a-form-item",{attrs:{label:"房间名称",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["room.rname"],expression:"['room.rname']"}],attrs:{disabled:!0}})],1),e._v(" "),a("a-form-item",{attrs:{label:"单价",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input-number",{attrs:{placeholder:"单价"},on:{change:e.handleChange},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}}),e._v("\n            元\n         ")],1),e._v(" "),a("a-form-item",{attrs:{label:"数量",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-select",{attrs:{placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.count,callback:function(t){e.count=t},expression:"count"}},[a("a-select-option",{attrs:{value:"1"}},[e._v("1")]),e._v(" "),a("a-select-option",{attrs:{value:"2"}},[e._v("2")]),e._v(" "),a("a-select-option",{attrs:{value:"3"}},[e._v("3")])],1)],1),e._v(" "),a("a-form-item",{attrs:{label:"总价",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input-number",{attrs:{placeholder:"总价"},model:{value:e.totalPrice,callback:function(t){e.totalPrice=t},expression:"totalPrice"}}),e._v("\n            元\n         ")],1),e._v(" "),a("a-form-item",{attrs:{label:"入住时间",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["startTime",{rules:[{required:!0,message:"入住时间不能为空"}]}],expression:"['startTime', {rules: [{ required: true, message: '入住时间不能为空' }]}]"}],staticStyle:{width:"100%"},attrs:{showTime:"",format:"YYYY/MM/DD HH:mm:ss",placeholder:"请选择入住时间"},on:{change:e.changeStartTime}})],1),e._v(" "),a("a-form-item",{attrs:{label:"离店时间",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["endTime",{rules:[{required:!0,message:"离店时间不能为空"}]}],expression:"['endTime', {rules: [{ required: true, message: '离店时间不能为空' }]}]"}],staticStyle:{width:"100%"},attrs:{showTime:"",format:"YYYY/MM/DD HH:mm:ss",placeholder:"请选择离店时间"},on:{change:e.changeEndTime}})],1),e._v(" "),a("a-form-item",{attrs:{label:"订单状态",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status"],expression:"['status']"}],attrs:{placeholder:"请选择"}},[a("a-select-option",{attrs:{value:"UNUSE"}},[e._v("待入住")]),e._v(" "),a("a-select-option",{attrs:{value:"UNPAY"}},[e._v("待付款")]),e._v(" "),a("a-select-option",{attrs:{value:"SUCCESS"}},[e._v("已完成")]),e._v(" "),a("a-select-option",{attrs:{value:"CANCEL"}},[e._v("已取消")]),e._v(" "),a("a-select-option",{attrs:{value:"REVIEWED"}},[e._v("已评价")])],1)],1),e._v(" "),a("a-form-item",{attrs:{label:"订单备注",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"['remark']"}]})],1)],1)],1)],1)],1)},staticRenderFns:[]};var b=a("VU/8")(v,f,!1,function(e){a("U+71")},"data-v-3439eace",null).exports,w={UNPAY:{status:"warning",text:"待付款"},UNUSE:{status:"processing",text:"待入住"},CANCEL:{status:"default",text:"已取消"},SUCCESS:{status:"success",text:"已完成"},REVIEWED:{status:"default",text:"已评价"}},C={name:"OrderManage",components:{STable:n.a,Ellipsis:l.a,getOrderList:m.f,deleteOrder:m.c,deleteIds:m.b,OrderEdit:b},filters:{statusFilter:function(e){return w[e].text},statusTypeFilter:function(e){return w[e].status}},data:function(){var e=this;return{zh_CN:i.a,form:this.$form.createForm(this,{name:"advanced_search"}),isDelete:!0,columns:[{title:"订单编号",dataIndex:"oid",align:"center"},{title:"酒店",dataIndex:"hotel.hname",align:"center"},{title:"入住人",dataIndex:"checkInPerson",align:"center"},{title:"总价",dataIndex:"totalPrice",sorter:!0,align:"center"},{title:"状态",dataIndex:"status",align:"center",sorter:!0,scopedSlots:{customRender:"status"}},{title:"下单时间",dataIndex:"createTime",sorter:!0,align:"center"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"},align:"center"}],queryValues:{},loadData:function(t){return e.form.validateFields(function(t,a){e.queryValues=a,void 0!==e.queryValues.startTime&&null!=e.queryValues.startTime&&(e.queryValues.startTime=d()(a.startTime).format("YYYY-MM-DD HH:mm:ss"))}),Object(m.f)(o()({},t,e.queryValues)).then(function(e){return!0===e.success?o()({},Object(u.a)(e)):Object(u.a)()}).catch(function(t){return e.$notification.error({message:"网络连接异常，请稍后再试"}),Object(u.a)()})},selectedRowKeys:[],selectedRows:[],options:{alert:{show:!0,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},optionAlertShow:!1}},methods:{reload:function(){this.$refs.table.refresh(!0)},handleSearch:function(e){e.preventDefault(),this.$refs.table.refresh(!0)},handleCleanPrice:function(){this.form.setFieldsValue({minPrice:void 0,maxPrice:void 0})},handleReset:function(){this.form.resetFields(),this.$refs.table.refresh(!0)},handleOk:function(){this.$refs.table.refresh()},handleEdit:function(e){this.$refs.modal.edit(e)},handleDelete:function(e){var t=this;Object(m.c)(e.oid).then(function(e){!0===e.success&&(t.$notification.success({message:"删除成功"}),t.$refs.table.refresh(!0))}).catch(function(e){t.$message.error("删除订单失败: "+e.message)})},DeleteIds:function(){for(var e=this,t=[],a=0;a<this.selectedRows.length;a++)t.push(this.selectedRows[a].oid);Object(m.b)(t).then(function(t){!0===t.success&&(e.$notification.success({message:"删除成功"}),e.selectedRowKeys.length=0,e.selectedRows.length=0,e.isDelete=!0,e.$refs.table.refresh(!0))}).catch(function(t){e.$message.error("批量删除失败: "+t.message)})},tableOption:function(){var e=this;this.optionAlertShow?(this.options={alert:!1,rowSelection:null},this.optionAlertShow=!1):(this.options={alert:{show:!1,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},this.optionAlertShow=!0)},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t,this.selectedRowKeys.length>0?this.isDelete=!1:this.isDelete=!0}},created:function(){this.tableOption()}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-locale-provider",{attrs:{locale:e.zh_CN}},[a("a-card",{attrs:{bordered:!1}},[a("div",{attrs:{id:"components-form-demo-advanced-search"}},[a("a-form",{staticClass:"ant-advanced-search-form",attrs:{form:e.form},on:{submit:e.handleSearch}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{key:"1",attrs:{span:8}},[a("a-form-item",{attrs:{label:"订单编号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["oid"],expression:"['oid']"}],attrs:{allowClear:""}})],1)],1),e._v(" "),a("a-col",{key:"2",attrs:{span:8}},[a("a-form-item",{attrs:{label:"入住人姓名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["uName"],expression:"['uName']"}],attrs:{allowClear:""}})],1)],1),e._v(" "),a("a-col",{key:"3",attrs:{span:8}},[a("a-form-item",{attrs:{label:"入住时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["startTime"],expression:"['startTime']"}],staticStyle:{width:"200px"},attrs:{format:"YYYY-MM-DD HH:mm:ss"}})],1)],1),e._v(" "),a("a-col",{key:"4",attrs:{span:8}},[a("a-form-item",{attrs:{label:"订单状态"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["orderStatus",{initialValue:"ALL"}],expression:"[\r\n                'orderStatus',\r\n                {\r\n                  initialValue: 'ALL'\r\n                }\r\n              ]"}],staticStyle:{width:"200px"}},[a("a-select-option",{attrs:{value:"ALL"}},[e._v("全部")]),e._v(" "),a("a-select-option",{attrs:{value:"UNUSE"}},[e._v("待入住")]),e._v(" "),a("a-select-option",{attrs:{value:"UNPAY"}},[e._v("待付款")]),e._v(" "),a("a-select-option",{attrs:{value:"SUCCESS"}},[e._v("已完成")]),e._v(" "),a("a-select-option",{attrs:{value:"CANCEL"}},[e._v("已取消")]),e._v(" "),a("a-select-option",{attrs:{value:"REVIEWED"}},[e._v("已评价")])],1)],1)],1),e._v(" "),a("a-col",{key:"5",attrs:{span:8}},[a("a-form-item",{attrs:{label:"酒店名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["hName"],expression:"['hName']"}]})],1)],1),e._v(" "),a("a-col",{key:"6",attrs:{span:8}},[a("a-form-item",{attrs:{label:"金额区间"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["minPrice"],expression:"['minPrice']"}],attrs:{min:0,max:9999}}),e._v("\r\n            -\r\n            "),a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["maxPrice"],expression:"['maxPrice']"}],attrs:{min:0,max:9999}}),e._v(" "),a("a-button",{style:{marginLeft:"8px"},on:{click:e.handleCleanPrice}},[e._v("清空")])],1)],1)],1),e._v(" "),a("a-row",[a("a-col",{style:{textAlign:"right"},attrs:{span:24}},[a("span",{style:{cursor:"pointer"},on:{click:e.reload}},[e._v("刷新"),a("a-icon",{attrs:{type:"reload"}})],1),e._v(" "),a("a-popconfirm",{style:{marginLeft:"8px"},on:{confirm:function(t){return e.DeleteIds()}}},[a("template",{slot:"title"},[e._v("\r\n              是否要删除所选？\r\n            ")]),e._v(" "),a("a-button",{attrs:{disabled:e.isDelete,type:"danger"}},[a("a-icon",{attrs:{type:"delete"}}),e._v("\r\n              批量删除\r\n            ")],1)],2),e._v(" "),a("a-button",{style:{marginLeft:"8px"},attrs:{type:"primary","html-type":"submit"}},[e._v("\r\n            查询\r\n          ")]),e._v(" "),a("a-button",{style:{marginLeft:"8px"},on:{click:e.handleReset}},[e._v("\r\n            重置\r\n          ")])],1)],1)],1)],1),e._v(" "),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"oid",columns:e.columns,data:e.loadData,alert:e.options.alert,rowSelection:e.options.rowSelection,showPagination:"auto"},scopedSlots:e._u([{key:"serial",fn:function(t,r,o){return a("span",{},[e._v(e._s(o+1))])}},{key:"status",fn:function(t){return a("span",{},[a("a-badge",{attrs:{status:e._f("statusTypeFilter")(t),text:e._f("statusFilter")(t)}})],1)}},{key:"description",fn:function(t){return a("span",{},[a("ellipsis",{attrs:{length:30,tooltip:""}},[e._v(e._s(t))])],1)}},{key:"createTime",fn:function(t){return a("span",{},[e._v(e._s(e._f("moment")(t)))])}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),e._v(" "),a("a-divider",{attrs:{type:"vertical"}}),e._v(" "),a("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(t){return e.handleDelete(r)}}},[a("a",{staticStyle:{color:"red"}},[e._v("删除")])])]],2)}}])}),e._v(" "),a("order-edit",{ref:"modal",on:{ok:e.handleOk}})],1)],1)},staticRenderFns:[]};var g=a("VU/8")(C,_,!1,function(e){a("NVPD")},"data-v-841b7cb0",null);t.default=g.exports},NVPD:function(e,t){},"U+71":function(e,t){}});
//# sourceMappingURL=6.2084e9bd8e9881ae81f0.js.map