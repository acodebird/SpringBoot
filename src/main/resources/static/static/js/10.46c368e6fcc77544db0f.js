webpackJsonp([10],{ilMa:function(a,e){},jeOw:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=t("M9A7"),r=t("lb5x"),i=t("aNLv"),o={name:"UserAdd",data:function(){return{form:this.$form.createForm(this),validateSta:{newPasswoed:"",confirm:""},disableGetCaptcha:!1,captchaInfo:{token:"",code:""},passwordInfo:{password:"",newPassword:""},getCaptchaStatus:{time:60,isDisable:!1,hideMessage:0},helpText:{newPassword:null},userInfo:i.e}},methods:{init:function(){this.captchaInfo.token="",this.captchaInfo.code="",this.disableGetCaptcha=!1,this.validateSta.newPassword=null,this.validateSta.confirm=null,this.helpText.newPassword=null,this.form.resetFields()},handleSubmit:function(){var a=this;this.form.validateFields;this.form.validateFields({force:!0},function(e,t){e?console.log("Setting.form.validateFields",e):(a.passwordInfo.password=t.password,a.passwordInfo.newPassword=t.newPassword,a.captchaInfo.code=t.captcha,a.getKey())})},handleValidNewPassword:function(a,e,t){/\S{6,18}$/.test(e)?/^[a-zA-Z][a-zA-Z0-9]/.test(e)?(/[^\w\s]+/.test(e)?(this.validateSta.newPassword="success",this.helpText.newPassword="密码强度: 强"):(this.validateSta.newPassword="warning",this.helpText.newPassword="密码强度: 弱"),t()):(this.validateSta.newPassword="error",this.helpText.newPassword="请输入字母开头的密码",t("请输入字母开头的密码")):(this.validateSta.newPassword="error",this.helpText.newPassword="密码长度要在6~18之间",t("密码长度要在6~18之间"))},handleValidConfirm:function(a,e,t){e&&e!==this.form.getFieldValue("newPassword")?(this.validateSta.confirm="error",t("输入密码不一致!")):(this.validateSta.confirm="success",t())},handleValidCaptcha:function(a,e,t){void 0===e&&t("请输入验证码"),4!=e.length&&t("请输入4位验证码"),e!==this.captchaInfo.code&&t("验证码不正确"),t()},getCaptcha:function(){var a=this;this.getCaptchaStatus.isDisable=!0;var e=window.setInterval(function(){a.getCaptchaStatus.time--<=0&&(a.getCaptchaStatus.time=60,a.getCaptchaStatus.isDisable=!1,window.clearInterval(e))},1e3);this.getCaptchaStatus.hideMessage=this.$message.loading("验证码发送中..",0),Object(s.g)(this.userInfo.email).then(function(e){if(setTimeout(a.getCaptchaStatus.hideMessage),!0===e.success)return a.captchaInfo=e.data,void a.$notification.success({message:"验证码已发送到邮箱: "+a.userInfo.email});a.$notification.error({message:"验证码发送失败: "+r.a[e.data]})}).catch(function(e){setTimeout(a.getCaptchaStatus.hideMessage),a.$notification.error({message:"请求出现错误，请稍后再试"}),console.log("请求出现错误，请稍后再试",e.message)})},getKey:function(){var a=this;Object(s.b)(this.userInfo.email).then(function(e){if(!0===e.success)return a.passwordInfo.password=Object(i.c)(a.passwordInfo.password,e.data),a.passwordInfo.newPassword=Object(i.c)(a.passwordInfo.newPassword,e.data),void a.submit(a.passwordInfo,a.captchaInfo);cb(1,"登录失败: "+r.a[e.data])}).catch(function(a){cb(2,"请求出现错误，请稍后再试"),console.log("请求出现错误，请稍后再试",a.message)})},submit:function(a,e){var t=this;Object(s.j)(a,e).then(function(a){if(!0===a.success)return t.$notification.success({message:"重置成功"}),t.init(),void t.exit();t.$notification.error({message:"重置失败: "+r.a[a.data]})}).catch(function(a){t.$notification.error({message:"请求出现错误，请稍后再试"}),console.log("请求出现错误，请稍后再试",a.message)})},exit:function(){var a=this;Object(s.e)().then(function(e){if(!0===e.success)return a.is_login=!1,Object(i.d)(null),void a.$router.push("/login");console.log("logout error",r.a[e.data])}).catch(function(a){console.log("logout error",a.message)})}},created:function(){var a=this;null===i.e?Object(s.c)().then(function(e){if(!0===e.success)return Object(i.d)(e.data),void(a.userInfo=e.data);console.log("isLogin error",r.a[e.data]),a.userInfo=null,a.$router.push("/login")}).catch(function(a){console.log("isLogin error",a.message)}):this.userInfo=i.e}},n={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"main"},[a._m(0),a._v(" "),t("a-form",{staticStyle:{"margin-top":"50px"},attrs:{form:a.form}},[t("a-form-item",{attrs:{label:"旧密码","label-col":{span:5},"wrapper-col":{span:12}}},[t("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入旧密码!"}]}],expression:"[\n        'password',\n        {rules: [{ required: true, message: '请输入旧密码!' }]}]"}],attrs:{placeholder:"旧密码/临时密码",type:"password"}})],1),a._v(" "),t("a-form-item",{attrs:{label:"新密码","label-col":{span:5},"wrapper-col":{span:12},"validate-status":a.validateSta.newPassword,help:a.helpText.newPassword}},[t("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["newPassword",{rules:[{required:!0,message:"请输入新密码!"},{validator:this.handleValidNewPassword}],validateTrigger:["change","blur"]}],expression:"[\n        'newPassword',\n        {rules: [{ required: true, message: '请输入新密码!' },{ validator: this.handleValidNewPassword }], validateTrigger: ['change', 'blur']}\n      ]"}],attrs:{type:"password"}})],1),a._v(" "),t("a-form-item",{attrs:{label:"确认密码","label-col":{span:5},"wrapper-col":{span:12},"validate-status":a.validateSta.confirm}},[t("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["confirm",{rules:[{required:!0,message:"请输入确认密码!"},{validator:this.handleValidConfirm}],validateTrigger:["change","blur"]}],expression:"[\n        'confirm',\n        {rules: [{ required: true, message: '请输入确认密码!' },{ validator: this.handleValidConfirm }], validateTrigger: ['change', 'blur']}\n      ]"}],attrs:{type:"password"}})],1),a._v(" "),t("a-form-item",{attrs:{label:"验证码","label-col":{span:5},"wrapper-col":{span:10}}},[t("a-row",[t("a-col",{staticClass:"gutter-row",attrs:{span:16}},[t("a-form-item",{attrs:{"wrapper-col":{span:20},"has-feedback":""}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",{rules:[{required:!0,message:" "},{validator:this.handleValidCaptcha}],validateTrigger:["change","blur"]}],expression:"['captcha', {rules: [{ required: true, message: ' ' },{ validator: this.handleValidCaptcha }], validateTrigger: ['change', 'blur']}]"}],attrs:{type:"text",placeholder:"验证码"}})],1)],1),a._v(" "),t("a-col",{staticClass:"gutter-row",attrs:{span:4}},[t("a-button",{attrs:{type:"primary",disabled:a.getCaptchaStatus.isDisable},on:{click:a.getCaptcha}},[a._v(a._s(a.getCaptchaStatus.isDisable?a.getCaptchaStatus.time+" s":"获取验证码"))])],1)],1)],1),a._v(" "),t("a-form-item",[t("a-row",{attrs:{type:"flex",justify:"space-around",align:"middle"}},[t("a-button",{staticStyle:{margin:"auto",float:"left"},attrs:{type:"primary"},on:{click:a.handleSubmit}},[a._v("重置密码")])],1)],1)],1)],1)},staticRenderFns:[function(){var a=this.$createElement,e=this._self._c||a;return e("div",{staticClass:"tit"},[e("h4",[this._v("修改密码")])])}]};var c=t("VU/8")(o,n,!1,function(a){t("ilMa")},"data-v-03fa1e11",null);e.default=c.exports}});
//# sourceMappingURL=10.46c368e6fcc77544db0f.js.map