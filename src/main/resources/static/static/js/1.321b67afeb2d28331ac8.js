webpackJsonp([1],{CWRd:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("W8/L"),n=a.n(s),i=a("FWz8"),r=a("gyZW"),o=a("mvHQ"),c=a.n(o),l=a("kFim"),u={name:"EvaluationOrder",data:function(){return{labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),rate:0,oid:""}},components:{},computed:{},methods:{evaluate:function(t){this.visible=!0,this.oid=t,this.rate=0,this.form.resetFields()},handleCancel:function(){this.visible=!1},handleSubmit:function(){var t=this,e=this.form.validateFields;this.confirmLoading=!0,e(function(e,a){if(!e){var s={content:a.content,rate:t.rate,oid:t.oid};return console.log("评价数据"+c()(s)),Object(l.a)(s).then(function(e){!0===e.success?(t.visible=!1,t.confirmLoading=!1,t.$message.success("评价成功！")):(t.confirmLoading=!1,t.$message.error("评价失败！"))}).catch(function(e){t.confirmLoading=!1,t.$message.error("评价出错！: "+e.message)})}t.confirmLoading=!1})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{title:"订单评价",width:640,visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"订单评分",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-rate",{attrs:{allowHalf:""},model:{value:t.rate,callback:function(e){t.rate=e},expression:"rate"}})],1),t._v(" "),a("a-form-item",{attrs:{label:"评价内容",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["content"],expression:"['content']"}],attrs:{placeholder:"评价内容",autosize:""}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var v=a("VU/8")(u,d,!1,function(t){a("tMDs")},"data-v-5dec45fa",null).exports,f=a("aNLv"),m={UNPAY:{status:"warning",text:"待付款"},UNUSE:{status:"processing",text:"待入住"},CANCEL:{status:"default",text:"已取消"},SUCCESS:{status:"success",text:"已完成"},REVIEWED:{status:"default",text:"已评价"}},p={STANDARD:{text:"标准房"},SUPERIOR:{text:"高级房"},DELUXE:{text:"豪华房"},BUSINESS:{text:"商务房"}},_={name:"MyOrders",created:function(){this.loadingData()},components:{EvaluateOrder:v},filters:{statusFilter:function(t){return m[t].text},statusTypeFilter:function(t){return m[t].status},roomTypeFilter:function(t){return p[t].text}},data:function(){return{zh_CN:n.a,status:"ALL",orders:[],count:0}},methods:{loadingData:function(){var t=this,e=f.e.uid;Object(i.e)(e,this.status).then(function(e){1==e.success?(t.orders=e.data,t.count=e.data.length):t.$message.error("加载订单失败: "+e.data)}).catch(function(e){t.$message.error("加载订单异常: "+e.message)})},handleChangeStatus:function(){this.loadingData()},getDateCount:function(t){return t.split(" ")[0].split("/")[2]},pay:function(t){this.$router.push({name:"Pay",params:{hotel:t.hotel,roomType:this.$options.filters.roomTypeFilter(t.room.type),startTime:t.startTime,endTime:t.endTime,totalPrice:t.totalPrice,oid:t.oid}})},detail:function(t){var e=this;Object(i.d)(t.oid).then(function(t){1==t.success?e.$router.push({name:"OrderDetail",params:{order:t.data,dateCount:e.getDateCount(t.data.endTime)-e.getDateCount(t.data.startTime)}}):e.$message.error("获取订单失败: "+t.data)}).catch(function(t){e.$message.error("获取订单异常: "+t.message)})},bookAgain:function(t){var e=this;Object(r.f)(t).then(function(t){1==t.success?e.$router.push({name:"HotelDetail",params:{hotelDetail:t.data}}):e.$message.error("获取酒店失败: "+t.data)}).catch(function(t){e.$message.error("获取酒店异常: "+t.message)})},deleteThis:function(t){var e=this;Object(i.c)(t).then(function(t){1==t.success?(e.$message.success("删除成功"),e.loadingData()):e.$message.error("删除订单失败: "+t.data)}).catch(function(t){e.$message.error("删除订单异常: "+t.message)})},evaluateOrder:function(t){console.log("打开评价框"),this.$refs.evaluateModal.evaluate(t)},handleOk:function(){this.$router.go(0)}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-locale-provider",{attrs:{locale:t.zh_CN}},[a("div",{staticClass:"main"},[a("div",{staticClass:"title"},[a("h4",[t._v("酒店订单("+t._s(t.count)+")")]),t._v(" "),a("div",{staticClass:"form-inline"},[a("a-select",{staticStyle:{width:"150px"},attrs:{defaultValue:t.status},on:{change:t.handleChangeStatus},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("a-select-option",{attrs:{value:"ALL"}},[t._v("全部")]),t._v(" "),a("a-select-option",{attrs:{value:"UNUSE"}},[t._v("待入住")]),t._v(" "),a("a-select-option",{attrs:{value:"UNPAY"}},[t._v("待付款")]),t._v(" "),a("a-select-option",{attrs:{value:"SUCCESS"}},[t._v("已完成")]),t._v(" "),a("a-select-option",{attrs:{value:"CANCEL"}},[t._v("已取消")]),t._v(" "),a("a-select-option",{attrs:{value:"REVIEWED"}},[t._v("已评价")])],1)],1)]),t._v(" "),a("div",{staticClass:"order-list"},[a("ul",[t._l(t.orders,function(e,s){return a("li",{key:s},[a("div",{staticClass:"title"},[a("span",[t._v("\r\n              订单号：\r\n              "),a("a",{on:{click:function(a){return t.detail(e)}}},[t._v(t._s(e.oid))])]),t._v(" "),a("span",[t._v("预订日期："+t._s(e.createTime))])]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"h-info"},[a("div",{staticClass:"pic"},[a("a",{on:{click:function(a){return t.detail(e)}}},[a("img",{attrs:{src:e.hotel.img}})])]),t._v(" "),a("div",{staticClass:"section"},[a("a",{on:{click:function(a){return t.detail(e)}}},[a("h4",[t._v(t._s(e.hotel.hname))])]),t._v(" "),a("p",[t._v(t._s(e.room.rname)+"("+t._s(t._f("roomTypeFilter")(e.room.type))+")")]),t._v(" "),a("p",[t._v("入住日期："+t._s(e.startTime))]),t._v(" "),a("p",[t._v("离店日期："+t._s(e.endTime))]),t._v(" "),a("p",[t._v("共"+t._s(t.getDateCount(e.endTime)-t.getDateCount(e.startTime))+"晚")])])]),t._v(" "),a("div",{staticClass:"price-box"},[a("div",{staticClass:"section"},[a("p",[t._v("总价")]),t._v(" "),a("p",{staticClass:"price"},[a("span",[t._v("￥"),a("b",[t._v(t._s(e.totalPrice))])])])])]),t._v(" "),a("div",{staticClass:"order-state"},[a("p",[a("a-badge",{attrs:{status:t._f("statusTypeFilter")(e.status),text:t._f("statusFilter")(e.status)}})],1)]),t._v(" "),a("div",{staticClass:"btn-box"},[a("div",{staticClass:"section"},["UNPAY"==e.status?a("a-button",{staticClass:"btn",staticStyle:{width:"88px"},attrs:{type:"primary"},on:{click:function(a){return t.pay(e)}}},[t._v("去付款")]):t._e(),t._v(" "),"UNUSE"==e.status?a("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(a){return t.detail(e)}}},[t._v("查看详情")]):t._e(),t._v(" "),"UNPAY"==e.status||"UNUSE"==e.status?a("a-button",{staticClass:"btn",attrs:{type:"danger"}},[a("a-popconfirm",{attrs:{title:"是否要取消此订单？"},on:{confirm:function(a){return t.deleteThis(e.oid)}}},[a("a",[t._v("取消订单")])])],1):t._e(),t._v(" "),"SUCCESS"==e.status||"CANCEL"==e.status||"REVIEWED"==e.status?a("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(a){return t.bookAgain(e.hotel.hid)}}},[t._v("再次预定")]):t._e(),t._v(" "),"SUCCESS"==e.status?a("a-button",{staticClass:"btn",staticStyle:{width:"88px"},attrs:{type:"default"},on:{click:function(a){return t.evaluateOrder(e.oid)}}},[t._v("评价订单")]):t._e(),t._v(" "),"REVIEWED"==e.status?a("a-button",{staticClass:"btn",staticStyle:{width:"88px"},attrs:{type:"default"},on:{click:function(a){return t.bookAgain(e.hotel.hid)}}},[t._v("查看评价")]):t._e(),t._v(" "),"CANCEL"==e.status?a("a-button",{staticClass:"btn",attrs:{type:"danger"}},[a("a-popconfirm",{attrs:{title:"是否要删除此订单？"},on:{confirm:function(a){return t.deleteThis(e.oid)}}},[a("a",[t._v("删除订单")])])],1):t._e()],1)])])])}),t._v(" "),0==t.orders.length?a("li",{staticStyle:{border:"0"}},[a("a-empty")],1):t._e()],2)]),t._v(" "),a("evaluate-order",{ref:"evaluateModal",on:{ok:t.handleOk}})],1)])},staticRenderFns:[]};var C=a("VU/8")(_,h,!1,function(t){a("HI2d")},"data-v-c52f74ce",null);e.default=C.exports},HI2d:function(t,e){},mvHQ:function(t,e,a){t.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(t,e,a){var s=a("FeBl"),n=s.JSON||(s.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},tMDs:function(t,e){}});
//# sourceMappingURL=1.321b67afeb2d28331ac8.js.map