webpackJsonp([7],{"8YqC":function(e,t){},"R+Na":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),r=a.n(n),o=a("W8/L"),s=a.n(o),i=a("glY1"),l=a("M1MM"),c=a("PJh5"),d=a.n(c),m=a("kFim"),u=a("DKUc"),p=a("+cTw"),f=a.n(p),v={name:"CommentReply",props:{record:{type:[Object,String],default:""}},data:function(){return{labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),cid:""}},components:{},computed:{},methods:{show:function(e){this.visible=!0},reply:function(e){this.visible=!0;var t=this.form.setFieldsValue,a=f()(e,["cid","content","reply"]);this.cid=a.cid,this.$nextTick(function(){t({content:a.content,reply:a.reply})})},handleSubmit:function(){var e=this,t=this.form.validateFields;this.confirmLoading=!0,t(function(t,a){if(!t){var n={cid:e.cid,reply:a.reply};return Object(m.e)(r()({},n)).then(function(t){!0===t.success?(e.visible=!1,e.confirmLoading=!1,e.$emit("ok",a),e.$notification.success({message:"回复成功"})):(e.confirmLoading=!1,e.$notification.error({message:"回复失败："+t.data}))})}e.confirmLoading=!1})},handleCancel:function(){this.visible=!1}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-modal",{attrs:{title:"回复评论",width:640,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"评论内容",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["content"],expression:"['content']"}],attrs:{disabled:!0,placeholder:"评论内容",autosize:""}})],1),e._v(" "),a("a-form-item",{attrs:{label:"回复内容",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["reply"],expression:"['reply']"}],attrs:{placeholder:"回复内容",autosize:""}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var y=a("VU/8")(v,h,!1,function(e){a("8YqC")},"data-v-2b10aaa0",null).exports,g={PRAISE:{text:"好评"},AVERAGE:{text:"中评"},CRITICIZE:{text:"差评"}},b={name:"CommentManage",components:{STable:i.a,Ellipsis:l.a,CommentReply:y},filters:{typeFilter:function(e){return g[e].text}},data:function(){var e=this;return{zh_CN:s.a,form:this.$form.createForm(this,{name:"advanced_search"}),columns:[{title:"主键",dataIndex:"cid",align:"center"},{title:"用户姓名",dataIndex:"user.uname",align:"center"},{title:"酒店名字",dataIndex:"hotel.hname",align:"center"},{title:"评论内容",dataIndex:"content",align:"center",scopedSlots:{customRender:"content"}},{title:"店长回复",dataIndex:"reply",align:"center",scopedSlots:{customRender:"reply"}},{title:"评论时间",dataIndex:"date",align:"center"},{title:"评论类别",dataIndex:"type",align:"center",scopedSlots:{customRender:"type"}},{title:"评分",dataIndex:"rate",width:"80px",align:"center"},{title:"操作",dataIndex:"action",align:"center",width:"150px",scopedSlots:{customRender:"action"}}],loadData:function(t){return e.form.validateFields(function(t,a){e.queryParam=a,console.log(e.queryParam.dateKey),void 0!==e.queryParam.dateKey&&null!=e.queryParam.dateKey&&(e.queryParam.dateKey=d()(a.dateKey).format("YYYY-MM-DD HH:mm:ss")),console.log(e.queryParam.dateKey)}),Object(m.d)(r()({sortField:"date"},t,e.queryParam)).then(function(e){return!0===e.success?r()({},Object(u.a)(e)):Object(u.a)()}).catch(function(e){return Object(u.a)()})},queryParam:{},selectedRowKeys:[],optionAlertShow:!1,loading:!1}},methods:{onSelectChange:function(e){this.selectedRowKeys=e},handleOk:function(){this.$refs.table.refresh()},handleReply:function(e){this.$refs.replyModal.reply(e)},handleDelete:function(e){var t=this;Object(m.b)(e).then(function(e){!0===e.success&&t.$notification.success({message:"删除成功!"}),t.$refs.table.refresh(!0)}).catch(function(e){t.$message.error("删除失败: "+e.message)})},handleDeleteAll:function(){var e=this;""==this.selectedRowKeys?this.$message.warning("请选择要删除的数据"):(this.loading=!0,Object(m.c)({ids:this.selectedRowKeys.join(",")}).then(function(t){!0===t.success&&(e.$notification.success({message:"批量删除成功！"}),e.loading=!1),e.selectedRowKeys=[],e.$refs.table.refresh(!0)}).catch(function(t){e.loading=!1,e.$message.error("批量删除失败: "+t.message)}))},handleSearch:function(e){e.preventDefault(),this.$refs.table.refresh(!0)},handleCleanRate:function(){this.form.setFieldsValue({minRateKey:void 0,maxRateKey:void 0})},handleReset:function(){this.form.resetFields(),this.$refs.table.refresh(!0)}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-locale-provider",{attrs:{locale:e.zh_CN}},[a("a-card",{attrs:{bordered:!1}},[a("div",{attrs:{id:"components-form-demo-advanced-search"}},[a("a-form",{staticClass:"ant-advanced-search-form",attrs:{form:e.form},on:{submit:e.handleSearch}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{key:"1",attrs:{span:8}},[a("a-form-item",{attrs:{label:"评论编号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["cidKey"],expression:"['cidKey']"}],attrs:{allowClear:""}})],1)],1),e._v(" "),a("a-col",{key:"2",attrs:{span:8}},[a("a-form-item",{attrs:{label:"用户姓名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["unameKey"],expression:"['unameKey']"}],attrs:{allowClear:""}})],1)],1),e._v(" "),a("a-col",{key:"3",attrs:{span:8}},[a("a-form-item",{attrs:{label:"酒店名字"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["hnameKey"],expression:"['hnameKey']"}],attrs:{allowClear:""}})],1)],1),e._v(" "),a("a-col",{key:"4",attrs:{span:8}},[a("a-form-item",{attrs:{label:"评论类型"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["typeKey"],expression:"['typeKey']"}],staticStyle:{width:"200px"},attrs:{placeholder:"请选择"}},[a("a-select-option",{attrs:{value:"PRAISE"}},[e._v("好评")]),e._v(" "),a("a-select-option",{attrs:{value:"AVERAGE"}},[e._v("中评")]),e._v(" "),a("a-select-option",{attrs:{value:"CRITICIZE"}},[e._v("差评")])],1)],1)],1),e._v(" "),a("a-col",{key:"5",attrs:{span:8}},[a("a-form-item",{attrs:{label:"评分区间"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["minRateKey"],expression:"['minRateKey']"}],attrs:{min:0,max:5}}),e._v("\r\n            -\r\n            "),a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["maxRateKey"],expression:"['maxRateKey']"}],attrs:{min:0,max:5}}),e._v(" "),a("a-button",{style:{marginLeft:"8px"},on:{click:e.handleCleanRate}},[e._v("清空")])],1)],1),e._v(" "),a("a-col",{key:"6",attrs:{span:8}},[a("a-form-item",{attrs:{label:"评论时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["dateKey"],expression:"['dateKey']"}],staticStyle:{width:"200px"},attrs:{format:"YYYY-MM-DD HH:mm:ss"}})],1)],1)],1),e._v(" "),a("a-row",[a("a-col",{style:{textAlign:"right"},attrs:{span:24}},[a("a-button",{style:{marginLeft:"8px"},attrs:{type:"primary","html-type":"submit"}},[e._v("\r\n            查询\r\n          ")]),e._v(" "),a("a-button",{style:{marginLeft:"8px"},on:{click:e.handleReset}},[e._v("\r\n            重置\r\n          ")])],1)],1)],1)],1),e._v(" "),a("div",{staticStyle:{"margin-bottom":"16px"}},[a("a-popconfirm",{attrs:{title:"确认删除所选数据?",okText:"是",cancelText:"否"},on:{confirm:e.handleDeleteAll}},[a("a-button",{attrs:{type:"danger",loading:e.loading}},[e._v("\r\n        批量删除\r\n      ")])],1)],1),e._v(" "),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"cid",columns:e.columns,data:e.loadData,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},showPagination:"auto"},scopedSlots:e._u([{key:"content",fn:function(t){return a("span",{},[a("ellipsis",{attrs:{length:30,tooltip:""}},[e._v(e._s(t))])],1)}},{key:"reply",fn:function(t){return a("span",{},[t&&t.length>0?[a("ellipsis",{attrs:{length:30,tooltip:""}},[e._v(e._s(t))])]:[a("a-icon",{attrs:{type:"ellipsis",title:"未回复"}})]],2)}},{key:"type",fn:function(t){return a("span",{},[e._v("\r\n        "+e._s(e._f("typeFilter")(t))+"\r\n      ")])}},{key:"action",fn:function(t,n){return a("span",{},[[a("a",{attrs:{title:"回复评论"},on:{click:function(t){return e.handleReply(n)}}},[a("a-icon",{attrs:{type:"message"}})],1),e._v(" "),a("a-divider",{attrs:{type:"vertical"}}),e._v(" "),a("a-popconfirm",{attrs:{title:"确认删除数据?",okText:"是",cancelText:"否"},on:{confirm:function(t){return e.handleDelete(n.cid)}}},[a("a",{staticStyle:{color:"red"},attrs:{title:"删除评论"}},[a("a-icon",{attrs:{type:"delete"}})],1)])]],2)}}])}),e._v(" "),a("comment-reply",{ref:"replyModal",on:{ok:e.handleOk}})],1)],1)},staticRenderFns:[]};var w=a("VU/8")(b,x,!1,function(e){a("wtXw")},"data-v-38744a3c",null);t.default=w.exports},wtXw:function(e,t){}});
//# sourceMappingURL=7.0dfdb16df9f20a2fa7e6.js.map